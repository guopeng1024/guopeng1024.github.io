<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Git Page | 郭鹏的学习笔记</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/docs/favorite.ico">
    <meta name="description" content="dayday up">
    
    <link rel="preload" href="/docs/assets/css/0.styles.f8601e9c.css" as="style"><link rel="preload" href="/docs/assets/js/app.76fef70f.js" as="script"><link rel="preload" href="/docs/assets/js/2.8652338c.js" as="script"><link rel="preload" href="/docs/assets/js/10.9ebc9598.js" as="script"><link rel="prefetch" href="/docs/assets/js/11.4ac4c708.js"><link rel="prefetch" href="/docs/assets/js/12.19fe7e7f.js"><link rel="prefetch" href="/docs/assets/js/13.8a921c0c.js"><link rel="prefetch" href="/docs/assets/js/14.e21571ba.js"><link rel="prefetch" href="/docs/assets/js/15.be57135e.js"><link rel="prefetch" href="/docs/assets/js/16.bf1da95d.js"><link rel="prefetch" href="/docs/assets/js/17.94289927.js"><link rel="prefetch" href="/docs/assets/js/18.e1d3e0b6.js"><link rel="prefetch" href="/docs/assets/js/19.559aa907.js"><link rel="prefetch" href="/docs/assets/js/20.e1145963.js"><link rel="prefetch" href="/docs/assets/js/21.219b490f.js"><link rel="prefetch" href="/docs/assets/js/22.6f4ba99a.js"><link rel="prefetch" href="/docs/assets/js/23.1d67784c.js"><link rel="prefetch" href="/docs/assets/js/24.38209c41.js"><link rel="prefetch" href="/docs/assets/js/3.63034ec6.js"><link rel="prefetch" href="/docs/assets/js/4.782e1469.js"><link rel="prefetch" href="/docs/assets/js/5.79cecb08.js"><link rel="prefetch" href="/docs/assets/js/6.dd8f2bc8.js"><link rel="prefetch" href="/docs/assets/js/7.aeb1dd0f.js"><link rel="prefetch" href="/docs/assets/js/8.d5e6e6e4.js"><link rel="prefetch" href="/docs/assets/js/9.30022ac3.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.f8601e9c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">郭鹏的学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/guopeng1024/guopeng1024.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/guopeng1024/guopeng1024.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Linux</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/Linux/gitpage+vuepress+jenkins静态博客.html" class="active sidebar-link">gitpage+vuepress+jen...</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Linux/gitpage+vuepress+jenkins静态博客.html#git-page" class="sidebar-link">Git Page</a></li><li class="sidebar-sub-header"><a href="/docs/Linux/gitpage+vuepress+jenkins静态博客.html#vuepress" class="sidebar-link">VuePress</a></li><li class="sidebar-sub-header"><a href="/docs/Linux/gitpage+vuepress+jenkins静态博客.html#jenkins部署" class="sidebar-link">Jenkins部署</a></li></ul></li><li><a href="/docs/Linux/http报文-概念状态码.html" class="sidebar-link">http报文-概念状态码</a></li><li><a href="/docs/Linux/http报文-首部.html" class="sidebar-link">http报文-首部</a></li><li><a href="/docs/Linux/linux常用指令.html" class="sidebar-link">linux常用指令</a></li><li><a href="/docs/Linux/markdown.html" class="sidebar-link">markdown</a></li><li><a href="/docs/Linux/shell-echo&amp;printf.html" class="sidebar-link">shell-echo&amp;printf</a></li><li><a href="/docs/Linux/shell-test验证.html" class="sidebar-link">shell-test验证</a></li><li><a href="/docs/Linux/shell-传递参数.html" class="sidebar-link">shell-传递参数</a></li><li><a href="/docs/Linux/shell-函数.html" class="sidebar-link">shell-函数</a></li><li><a href="/docs/Linux/shell-基础.html" class="sidebar-link">shell-基础</a></li><li><a href="/docs/Linux/shell-模块化.html" class="sidebar-link">shell-模块化</a></li><li><a href="/docs/Linux/shell-流程控制-if&amp;for.html" class="sidebar-link">shell-流程控制-if&amp;for</a></li><li><a href="/docs/Linux/shell-疑问记录.html" class="sidebar-link">shell-疑问记录</a></li><li><a href="/docs/Linux/shell-输入输出重定向.html" class="sidebar-link">shell-输入输出重定向</a></li><li><a href="/docs/Linux/shell-运算符.html" class="sidebar-link">shell-运算符</a></li><li><a href="/docs/Linux/windows快捷键.html" class="sidebar-link">windows快捷键</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="git-page"><a href="#git-page" class="header-anchor">#</a> Git Page</h2> <ol><li>GitHub新建仓库(&lt;github user&gt;.github.io最终生成的访问链接是同名的，推荐配置此仓库名)</li> <li>tab找到 <code>settings</code> =&gt; <code>GitHub Pages</code> =&gt; <code>source</code>下拉选择 <code>master branch</code><br> <img src="https://img.lihx.top/images/2020/01/14/image.png" alt="image.png"></li> <li>现在，可以直接访问git page了，由于仓库master分支上还未部署html代码，所以可能是空白页面，接下来使用vuepress生成静态页面</li></ol> <h2 id="vuepress"><a href="#vuepress" class="header-anchor">#</a> VuePress</h2> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <ol><li>git clone 刚才创建的仓库，作为vuepress的运行目录。</li> <li>安装 <code>npm i vuepress -D</code>，个人认为不需要将其安装到全局</li> <li>保证项目根路径下有一个markdown文件：<code>readme.md</code><div class="language- extra-class"><pre class="language-text"><code> # 测试大标题

 - 列表1
 - 列表2
</code></pre></div></li> <li>运行 - 执行指令 <code>npx vuepress dev</code></li> <li>构建发布 - <code>npx vuepress build</code><br>
默认会在 <code>.vuepress</code> =&gt; <code>dist</code> 目录下生成html页面，因为git page只识别master分支下的根目录或者docs/文件夹。稍后需要修改HTML的输出目录</li></ol> <h3 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h3> <p>（1） 在根目录下新建目录 <code>.vuepress</code><br>
（2） 自定义配置：新建文件 <code>config.js</code><br>
更多配置查看<a href="https://vuepress.vuejs.org/zh/guide/" target="_blank" rel="noopener noreferrer">官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>由于vuepress暂时不支持根据目录自动生成侧边栏，自己写了一个vuepress的插件 <code>vuepress-auto-sidebar.js</code>,<a href="https://github.com/justwe7/vuepress-auto-sidebar.js" target="_blank" rel="noopener noreferrer">仓库地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 需要以commonjs规范导出配置</span>
<span class="token keyword">const</span> autoSidebar <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vuepress-auto-sidebar.js'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  dest<span class="token operator">:</span> <span class="token string">'docs'</span><span class="token punctuation">,</span> <span class="token comment">// 配置 html 的输出目录</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      autoSidebar<span class="token punctuation">,</span>
      <span class="token comment">// { base: 'doc' }</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>再次打包<code>npx vuepress build</code>会生成一个docs目录，html文件生成在目录中</strong></p> <p>（3） 将改动push到master分支，然后在setting中修改Git Page的设置，选中<code>master branch/docs folder</code><br>
（4） 访问Git Page的url，可以看到vuepress生成的静态页面已经生效</p> <h2 id="jenkins部署"><a href="#jenkins部署" class="header-anchor">#</a> Jenkins部署</h2> <blockquote><p>首先在GitHub仓库新增一个feature分支</p></blockquote> <h3 id="_1-新建一个构建任务"><a href="#_1-新建一个构建任务" class="header-anchor">#</a> （1）新建一个构建任务</h3> <p>选择第一项：<code>Freestyle project</code></p> <h3 id="_2-配置源码地址"><a href="#_2-配置源码地址" class="header-anchor">#</a> （2）配置源码地址</h3> <p>指定拉取的分支为feature，<strong>以后feature用来更新内容，master分支只用来部署HTML页面</strong>（对应的，需要基于master分支拉取一个feature分支并push到GitHub仓库）<br> <img src="https://img.lihx.top/images/2020/01/14/image8c8c0.png" alt="image8c8c0.png"></p> <h3 id="_3-配置构建任务"><a href="#_3-配置构建任务" class="header-anchor">#</a> （3）配置构建任务</h3> <p><img src="https://img.lihx.top/images/2020/01/14/imagecf199.png" alt="imagecf199.png"><br>
弹出的输入框中填写如下shell指令：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;安装依赖...&quot;</span>
<span class="token function">npm</span> i
<span class="token builtin class-name">echo</span> <span class="token string">&quot;安装依赖成功，开始打包...&quot;</span>
<span class="token function">npm</span> run build
<span class="token builtin class-name">cd</span> docs
<span class="token function">git</span> init
<span class="token builtin class-name">echo</span> <span class="token string">&quot;开始发布到远端...&quot;</span>
<span class="token function">git</span> config user.name <span class="token string">'justwe7'</span>
<span class="token function">git</span> config user.email <span class="token string">'ilihuaxi@gmail.com'</span>
<span class="token function">git</span> remote <span class="token function">add</span> origin https://name:password@github.com/justwe7/blog.git

<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token function">git</span> commit -m <span class="token string">'jenkins: auto deploy'</span>
<span class="token function">git</span> push origin HEAD:master --force
<span class="token builtin class-name">echo</span> <span class="token string">&quot;发布完成！！！&quot;</span>
</code></pre></div><blockquote><p>git config username和email信息需要填写自己的</p></blockquote> <blockquote><p>remote地址name和password需要替换成自己的GitHub的name和密码</p></blockquote> <p>此时点击build应该可以将feature分支的markdown文章生成html静态页面，并将html文件推送到master下，目录结构差不多是这样：<br> <img src="https://img.lihx.top/images/2020/01/14/image2f410.png" alt="image2f410.png"></p> <p>😂需要再去settings将Git Page的select改回<code>master</code>。--- 页面可以正常访问了。</p> <p><strong>构建后要将当前的文件清空，避免影响下次构建</strong>
选中<code>Delete workspace when build is done</code>：<br> <img src="https://img.lihx.top/images/2020/01/14/image66c2b.png" alt="image66c2b.png"></p> <h3 id="_4-配置git-hooks触发自动构建"><a href="#_4-配置git-hooks触发自动构建" class="header-anchor">#</a> （4）配置git hooks触发自动构建</h3> <h4 id="生成github-token"><a href="#生成github-token" class="header-anchor">#</a> 生成GitHub token</h4> <ol><li>进入GitHub，点击右上角头像 =&gt; settings</li> <li>左边找到 Developer settings 点击</li> <li>点击 Personal access tokens<br> <a href="https://img.lihx.top/image/XB48" target="_blank" rel="noopener noreferrer"><img src="https://img.lihx.top/images/2020/01/14/imaged5c7d.png" alt="imaged5c7d.png"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>点击右上角的Generate new token按钮，生成的token只会展示一次，记得保存好</li></ol> <h4 id="jenkins配置"><a href="#jenkins配置" class="header-anchor">#</a> Jenkins配置</h4> <ol><li>去到Jenkins首页。在系统设置页面找到”GitHub”，点击添加GitHub Server，如下图，名称随便起，API URL填写https://api.github.com，凭据位置如下图红框所示，选中管理 Hook选择Add -&gt;Jenkins：</li></ol> <p><img src="https://img.lihx.top/images/2020/01/04/image.png" alt="image.png"></p> <ol start="2"><li><p>填写刚刚从GitHub生成的token：<br> <img src="https://img.lihx.top/images/2020/01/04/image242f4.png" alt="image242f4.png"></p></li> <li><p>配置完成可以试试是否可以正确连接：
<img src="https://img.lihx.top/images/2020/01/04/image11a35.png" alt="image11a35.png"></p></li> <li><p>勾选<code>为 Github 指定另外一个 Hook URL</code>，将生成的Jenkins hook地址复制
<img src="https://img.lihx.top/images/2020/01/14/imagee3427.png" alt="imagee3427.png"></p></li> <li><p>去到GitHub的仓库，settings =&gt; webhooks 点击add webhooks按钮,会要求输入GitHub密码，然后在输入框中填写Jenkins hook的地址</p></li></ol> <p><img src="https://img.lihx.top/images/2020/01/14/imagee4ac4.png" alt="imagee4ac4.png"></p> <ol start="6"><li>回到Jenkins任务配置，添加两项配置：
secret 选择刚刚在Jenkins配置中添加的GitHub token的label</li></ol> <p><img src="https://img.lihx.top/images/2020/01/14/image7c0cc.png" alt="image7c0cc.png"></p> <p>！！保存</p> <ol start="7"><li>此时在GitHub，feature分支push会触发GitHub hook =&gt; Jenkins拉取代码 =&gt; 自动打包 =&gt; push到仓库master分支，实现自动化部署静态笔记</li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/guopeng1024/guopeng1024.github.io/edit/main/Linux/gitpage+vuepress+jenkins静态博客.md" target="_blank" rel="noopener noreferrer">纠正错误</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">最近提交:</span> <span class="time">12/3/2020, 9:00:10 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/docs/Linux/http报文-概念状态码.html">
        http报文-概念状态码
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/docs/assets/js/app.76fef70f.js" defer></script><script src="/docs/assets/js/2.8652338c.js" defer></script><script src="/docs/assets/js/10.9ebc9598.js" defer></script>
  </body>
</html>
